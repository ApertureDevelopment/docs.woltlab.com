<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>Migrating from WSC 3.0 - PHP | WoltLab Suite 5.3 Documentation</title>

<link rel="stylesheet" href="https://docs.woltlab.com/css/syntax.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600">
<link rel="stylesheet" href="https://docs.woltlab.com/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="https://docs.woltlab.com/css/modern-business.css">
<link rel="stylesheet" href="https://docs.woltlab.com/css/lavish-bootstrap.css">
<link rel="stylesheet" href="https://docs.woltlab.com/css/customstyles.css">
<link rel="stylesheet" href="https://docs.woltlab.com/css/theme-blue.css?v=3">

<script src="https://docs.woltlab.com/js/jquery.min.js"></script>
<script src="https://docs.woltlab.com/js/jquery.cookie.min.js"></script>
<script src="https://docs.woltlab.com/js/jquery.navgoco.min.js"></script>
<script src="https://docs.woltlab.com/js/bootstrap.min.js"></script>
<script src="https://docs.woltlab.com/js/anchor.min.js"></script>
<script src="https://docs.woltlab.com/js/toc.js"></script>
<script src="https://docs.woltlab.com/js/customscripts.js"></script>

<link rel="shortcut icon" href="https://docs.woltlab.com/images/favicon.ico">

<link rel="alternate" type="application/rss+xml" title="mike-test" href="https://docs.woltlab.comfeed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>
  <!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> WoltLab Suite 5.3 Documentation</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                
                
                <li><a href="https://www.woltlab.com" target="_blank">woltlab.com</a></li>
                
                
                
                
                
                <li><a href="https://github.com/WoltLab/WCF/" target="_blank">Code on github.com</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="https://docs.woltlab.com/js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'https://docs.woltlab.com/search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Migrating from WSC 3.0 - PHP">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>


  <div class="container">
    <div class="col-lg-12">&nbsp;</div>

    <div class="row">
      <div class="col-md-3">
        


<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">WoltLab Suite 5.3</li>

    
        
            <li>
                <a href="#">Getting Started</a>
                <ul>
                    
                        
                            
                            
                                <li data-identifier="index"><a href="index.html">Introduction</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="getting-started_quick-start"><a href="getting-started_quick-start.html">Quick Start</a></li>
                            
                        

                        
                    
                </ul>
            </li>
        
            <li>
                <a href="#">PHP API</a>
                <ul>
                    
                        
                            
                            
                                <li data-identifier="php_pages"><a href="php_pages.html">Pages</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="php_database-objects"><a href="php_database-objects.html">Database Objects</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="php_database-access"><a href="php_database-access.html">Database Access</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="php_exceptions"><a href="php_exceptions.html">Exceptions</a></li>
                            
                        

                        
                    
                        

                        
                            <li class="subfolders">
                                <a href="#">API</a>
                                <ul>
                                    
                                        
                                        
                                            <li data-identifier="php_api_caches"><a href="php_api_caches.html">Caches</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="php_api_comments"><a href="php_api_comments.html">Comments</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="php_api_cronjobs"><a href="php_api_cronjobs.html">Cronjobs</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="php_api_events"><a href="php_api_events.html">Events</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="php_api_form_builder"><a href="php_api_form_builder.html">Form Builder</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="php_api_package_installation_plugins"><a href="php_api_package_installation_plugins.html">Package Installation Plugins</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="php_api_user_activity_points"><a href="php_api_user_activity_points.html">User Activity Points</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="php_api_user_notifications"><a href="php_api_user_notifications.html">User Notifications</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="php_api_sitemaps"><a href="php_api_sitemaps.html">Sitemaps</a></li>
                                        
                                    
                                </ul>
                            </li>
                        
                    
                        
                            
                            
                                <li data-identifier="php_code-style"><a href="php_code-style.html">Code Style</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="php_apps"><a href="php_apps.html">Apps</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="php_gdpr"><a href="php_gdpr.html">GDPR</a></li>
                            
                        

                        
                    
                </ul>
            </li>
        
            <li>
                <a href="#">Languages, Templates & CSS</a>
                <ul>
                    
                        
                            
                            
                                <li data-identifier="view_languages"><a href="view_languages.html">Languages</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="view_templates"><a href="view_templates.html">Templates</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="view_css"><a href="view_css.html">CSS</a></li>
                            
                        

                        
                    
                </ul>
            </li>
        
            <li>
                <a href="#">JavaScript API</a>
                <ul>
                    
                        
                            
                            
                                <li data-identifier="javascript_general-usage"><a href="javascript_general-usage.html">General Usage</a></li>
                            
                        

                        
                    
                        

                        
                            <li class="subfolders">
                                <a href="#">New API</a>
                                <ul>
                                    
                                        
                                        
                                            <li data-identifier="javascript_new-api_writing-a-module"><a href="javascript_new-api_writing-a-module.html">Writing a module</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="javascript_new-api_data-structures"><a href="javascript_new-api_data-structures.html">Data Structures</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="javascript_new-api_core"><a href="javascript_new-api_core.html">Core Functions</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="javascript_new-api_dom"><a href="javascript_new-api_dom.html">DOM</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="javascript_new-api_events"><a href="javascript_new-api_events.html">Event Handling</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="javascript_new-api_ajax"><a href="javascript_new-api_ajax.html">Ajax</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="javascript_new-api_dialogs"><a href="javascript_new-api_dialogs.html">Dialogs</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="javascript_new-api_browser"><a href="javascript_new-api_browser.html">Browser and Screen Sizes</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="javascript_new-api_ui"><a href="javascript_new-api_ui.html">User Interface</a></li>
                                        
                                    
                                </ul>
                            </li>
                        
                    
                        
                            
                            
                                <li data-identifier="javascript_legacy-api"><a href="javascript_legacy-api.html">Legacy API</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="javascript_helper-functions"><a href="javascript_helper-functions.html">Helper Functions</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="javascript_code-snippets"><a href="javascript_code-snippets.html">Code Snippets</a></li>
                            
                        

                        
                    
                </ul>
            </li>
        
            <li>
                <a href="#">Package Components</a>
                <ul>
                    
                        
                            
                            
                                <li data-identifier="package_package-xml"><a href="package_package-xml.html">package.xml</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="package_pip"><a href="package_pip.html">PIPs</a></li>
                            
                        

                        
                    
                </ul>
            </li>
        
            <li>
                <a href="#">Migration</a>
                <ul>
                    
                        

                        
                            <li class="subfolders">
                                <a href="#">Migrating from WSC 5.2</a>
                                <ul>
                                    
                                        
                                        
                                            <li data-identifier="migration_wsc-52_php"><a href="migration_wsc-52_php.html">PHP API</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="migration_wsc-52_templates"><a href="migration_wsc-52_templates.html">Templates and Languages</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="migration_wsc-52_libraries"><a href="migration_wsc-52_libraries.html">Third Party Libraries</a></li>
                                        
                                    
                                </ul>
                            </li>
                        
                            <li class="subfolders">
                                <a href="#">Migrating from WSC 3.1</a>
                                <ul>
                                    
                                        
                                        
                                            <li data-identifier="migration_wsc-31_php"><a href="migration_wsc-31_php.html">PHP API</a></li>
                                        
                                    
                                </ul>
                            </li>
                        
                            <li class="subfolders">
                                <a href="#">Migrating from WSC 3.0</a>
                                <ul>
                                    
                                        
                                        
                                            <li class="active" data-identifier="migration_wsc-30_php"><a href="migration_wsc-30_php.html">PHP API</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="migration_wsc-30_javascript"><a href="migration_wsc-30_javascript.html">JavaScript API</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="migration_wsc-30_templates"><a href="migration_wsc-30_templates.html">Templates</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="migration_wsc-30_css"><a href="migration_wsc-30_css.html">CSS</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="migration_wsc-30_package"><a href="migration_wsc-30_package.html">Package Components</a></li>
                                        
                                    
                                </ul>
                            </li>
                        
                            <li class="subfolders">
                                <a href="#">Migrating from WCF 2.1</a>
                                <ul>
                                    
                                        
                                        
                                            <li data-identifier="migration_wcf-21_php"><a href="migration_wcf-21_php.html">PHP API</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="migration_wcf-21_templates"><a href="migration_wcf-21_templates.html">Templates</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="migration_wcf-21_css"><a href="migration_wcf-21_css.html">CSS</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="migration_wcf-21_package"><a href="migration_wcf-21_package.html">Package Components</a></li>
                                        
                                    
                                </ul>
                            </li>
                        
                    
                </ul>
            </li>
        
            <li>
                <a href="#">Tutorials</a>
                <ul>
                    
                        
                            
                            
                                <li data-identifier="tutorial_tutorial-series"><a href="tutorial_tutorial-series.html">Tutorial Series</a></li>
                            
                        

                        
                    
                </ul>
            </li>
        
    
</ul>

<script>
(function() {
    var sidebar = $('#mysidebar');
    var item = sidebar.find('.active');
    if (item.length === 0) {
        var parent = '';
        if (parent) {
            sidebar.find('li[data-identifier="' + parent + '"]').addClass('active');
        }
    }

    sidebar.find(".active").parents('li').toggleClass("active");
})();
</script>

      </div>

      <div class="col-md-9">
        <div class="post-header">
   <h1 class="post-title-main">Migrating from WSC 3.0 - PHP</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    
    
  <h2 id="approval-system-for-comments">Approval-System for Comments</h2>

<p>Comments can now be set to require approval by a moderator before being published. This feature is disabled by default if you do not provide a permission in the manager class, enabling it requires a new permission that has to be provided in a special property of your manage implementation.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="kd">class</span> <span class="nc">ExampleCommentManager</span> <span class="k">extends</span> <span class="nx">AbstractCommentManager</span> <span class="p">{</span>
  <span class="k">protected</span> <span class="nv">$permissionAddWithoutModeration</span> <span class="o">=</span> <span class="s1">'foo.bar.example.canAddCommentWithoutModeration'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="raw-html-in-user-activity-events">Raw HTML in User Activity Events</h2>

<p>User activity events were previously encapsulated inside <code class="language-plaintext highlighter-rouge">&lt;div class="htmlContent"&gt;…&lt;/div&gt;</code>, with impacts on native elements such as lists. You can now disable the class usage by defining your event as raw HTML:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="kd">class</span> <span class="nc">ExampleUserActivityEvent</span> <span class="p">{</span>
  <span class="c1">// enables raw HTML for output, defaults to `false`</span>
  <span class="k">protected</span> <span class="nv">$isRawHtml</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="permission-to-view-likes-of-an-object">Permission to View Likes of an Object</h2>

<p>Being able to view the like summary of an object was restricted to users that were able to like the object itself. This creates situations where the object type in general is likable, but the particular object cannot be liked by the current users, while also denying them to view the like summary (but it gets partly exposed through the footer note/summary!).</p>

<p>Implement the interface <code class="language-plaintext highlighter-rouge">\wcf\data\like\IRestrictedLikeObjectTypeProvider</code> in your object provider to add support for this new permission check.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="kd">class</span> <span class="nc">LikeableExampleProvider</span> <span class="k">extends</span> <span class="nx">ExampleProvider</span> <span class="k">implements</span> <span class="nx">IRestrictedLikeObjectTypeProvider</span><span class="p">,</span> <span class="nx">IViewableLikeProvider</span> <span class="p">{</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">canViewLikes</span><span class="p">(</span><span class="nx">ILikeObject</span> <span class="nv">$object</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// perform your permission checks here</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="developer-tools-sync-feature">Developer Tools: Sync Feature</h2>

<p>The synchronization feature of the newly added developer tools works by invoking a package installation plugin (PIP) outside of a regular installation, while simulating the basic environment that is already exposed by the API.</p>

<p>However, not all PIPs qualify for this kind of execution, especially because it could be invoked multiple times in a row by the user. This is solved by requiring a special marking for PIPs that have no side-effects (= idempotent) when invoked any amount of times with the same arguments.</p>

<p>There’s another feature that allows all matching PIPs to be executed in a row using a single button click. In order to solve dependencies on other PIPs, any implementing PIP must also provide the method <code class="language-plaintext highlighter-rouge">getSyncDependencies()</code> that returns the dependent PIPs in an arbitrary order.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="kd">class</span> <span class="nc">ExamplePackageInstallationPlugin</span> <span class="k">extends</span> <span class="nx">AbstractXMLPackageInstallationPlugin</span> <span class="k">implements</span> <span class="nx">IIdempotentPackageInstallationPlugin</span> <span class="p">{</span>
  <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">getSyncDependencies</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// provide a list of dependent PIPs in arbitrary order</span>
    <span class="k">return</span> <span class="p">[];</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="media-providers">Media Providers</h2>

<p>Media providers were added through regular SQL queries in earlier versions, but this is neither convenient, nor did it offer a reliable method to update an existing provider. WoltLab Suite 3.1 adds a new <code class="language-plaintext highlighter-rouge">mediaProvider</code>-PIP that also offers a <code class="language-plaintext highlighter-rouge">className</code> parameter to off-load the result evaluation and HTML generation.</p>

<h3 id="example-implementation">Example Implementation</h3>

<h4 id="mediaproviderxml">mediaProvider.xml</h4>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;data</span> <span class="na">xmlns=</span><span class="s">"http://www.woltlab.com"</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.woltlab.com http://www.woltlab.com/XSD/tornado/mediaProvider.xsd"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;import&gt;</span>
    <span class="nt">&lt;provider</span> <span class="na">name=</span><span class="s">"example"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;title&gt;</span>Example Provider<span class="nt">&lt;/title&gt;</span>
      <span class="nt">&lt;regex&gt;</span><span class="cp">&lt;![CDATA[https?://example.com/watch?v=(?P&lt;ID&gt;[a-zA-Z0-9])]]&gt;</span><span class="nt">&lt;/regex&gt;</span>
      <span class="nt">&lt;className&gt;</span><span class="cp">&lt;![CDATA[wcf\system\bbcode\media\provider\ExampleBBCodeMediaProvider]]&gt;</span><span class="nt">&lt;/className&gt;</span>
    <span class="nt">&lt;/provider&gt;</span>
  <span class="nt">&lt;/import&gt;</span>
<span class="nt">&lt;/data&gt;</span>
</code></pre></div></div>

<h4 id="php-callback">PHP Callback</h4>

<p>The full match is provided for <code class="language-plaintext highlighter-rouge">$url</code>, while any capture groups from the regular expression are assigned to <code class="language-plaintext highlighter-rouge">$matches</code>.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="kd">class</span> <span class="nc">ExampleBBCodeMediaProvider</span> <span class="k">implements</span> <span class="nx">IBBCodeMediaProvider</span> <span class="p">{</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">parse</span><span class="p">(</span><span class="nv">$url</span><span class="p">,</span> <span class="k">array</span> <span class="nv">$matches</span> <span class="o">=</span> <span class="p">[])</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">"final HTML output"</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="re-evaluate-html-messages">Re-Evaluate HTML Messages</h2>

<div class="bs-callout bs-callout-warning">You need to manually set the disallowed bbcodes in order to avoid unintentional bbcode evaluation. Please see <a href="https://github.com/WoltLab/WCF/commit/7e058783da1378dda5393a9bb4df9cfe94e5b394">this commit</a> for a reference implementation inside worker processes.</div>

<p>The HtmlInputProcessor only supported two ways to handle an existing HTML message:</p>

<ol>
  <li>Load the string through <code class="language-plaintext highlighter-rouge">process()</code> and run it through the validation and sanitation process, both of them are rather expensive operations and do not qualify for rebuild data workers.</li>
  <li>Detect embedded content using <code class="language-plaintext highlighter-rouge">processEmbeddedContent()</code> which bypasses most tasks that are carried out by <code class="language-plaintext highlighter-rouge">process()</code> which aren’t required, but does not allow a modification of the message.</li>
</ol>

<p>The newly added method <code class="language-plaintext highlighter-rouge">reprocess($message, $objectType, $objectID)</code> solves this short-coming by offering a full bbcode and text re-evaluation while bypassing any input filters, assuming that the input HTML was already filtered previously.</p>

<h3 id="example-usage">Example Usage</h3>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="c1">// rebuild data workers tend to contain code similar to this:</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">objectList</span> <span class="k">as</span> <span class="nv">$message</span><span class="p">)</span> <span class="p">{</span>
 <span class="c1">// ...</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$message</span><span class="o">-&gt;</span><span class="na">enableHtml</span><span class="p">)</span> <span class="p">{</span>
   <span class="c1">// ...</span>
 <span class="p">}</span>
 <span class="k">else</span> <span class="p">{</span>
   <span class="c1">// OLD:</span>
   <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getHtmlInputProcessor</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">processEmbeddedContent</span><span class="p">(</span><span class="nv">$message</span><span class="o">-&gt;</span><span class="na">message</span><span class="p">,</span> <span class="s1">'com.example.foo.message'</span><span class="p">,</span> <span class="nv">$message</span><span class="o">-&gt;</span><span class="na">messageID</span><span class="p">);</span>

   <span class="c1">// REPLACE WITH:</span>
   <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getHtmlInputProcessor</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">reprocess</span><span class="p">(</span><span class="nv">$message</span><span class="o">-&gt;</span><span class="na">message</span><span class="p">,</span> <span class="s1">'com.example.foo.message'</span><span class="p">,</span> <span class="nv">$message</span><span class="o">-&gt;</span><span class="na">messageID</span><span class="p">);</span>
   <span class="nv">$data</span><span class="p">[</span><span class="s1">'message'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getHtmlInputProcessor</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getHtml</span><span class="p">();</span>
 <span class="p">}</span>
 <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></div>



    <div class="tags">
        
    </div>

    

</div>

      </div>
    </div>
  </div>

  <div class="footerBox">
    <div class="container">
      <div class="footerBoxLeft">
        
        <a target="_blank" href="https://github.com/woltlab/woltlab.github.io/blob/master/pages/migration/wsc-30/migration_wsc-30_php.md" class="btn btn-default githubEditButton no_icon" role="button"><i class="fa fa-github fa-lg"></i> Edit on GitHub</a>
        <p>Site last generated: Mar 2, 2021</p>
      </div>
      <div class="footerBoxRight">
        <a class="no_icon" href="https://www.woltlab.com"><img src="https://docs.woltlab.com/images/woltlab-black.png" srcset="https://docs.woltlab.com/images/woltlab-black@2x.png 2x" height="40" width="204" alt=""></a>
      </div>
    </div>
  </div>

  <div class="pageFooter">
    <div class="container">
      &copy; 2001 ‐ 2021 <a class="no_icon" href="https://www.woltlab.com">WoltLab GmbH</a>. All rights reserved. | <a class="no_icon" href="https://www.woltlab.com/legal-notice/">Legal Notice</a> | <a class="no_icon" href="https://www.woltlab.com/privacy-policy/">Privacy Policy</a>
    </div>
  </div>
</body>

</html>
